# Claude Web é¡¹ç›®è®°å¿†

## é¡¹ç›®æ¦‚è¿°
Claude Web æ˜¯ä¸€ä¸ªåŸºäº Web çš„è¿œç¨‹å¼€å‘ç¯å¢ƒï¼Œå…è®¸ç”¨æˆ·é€šè¿‡æµè§ˆå™¨è®¿é—®å’Œæ§åˆ¶è¿œç¨‹æœåŠ¡å™¨ä¸Šçš„ Claude Code å’Œ VS Code (Cursor)ã€‚

## æŠ€æœ¯æ ˆå†³ç­–
- **æ¶æ„æ–¹æ¡ˆ**: è‡ªå»º PTY æ–¹æ¡ˆï¼ˆnode-pty + WebSocketï¼‰
- **å‰ç«¯**: React + TypeScript + xterm.js + Material-UI
- **åç«¯**: Fastify + WebSocket + node-pty
- **æ•°æ®åº“**: PostgreSQL (å†å²è®°å½•) + Redis (ä¼šè¯ç®¡ç†)
- **IDEé›†æˆ**: code-server
- **éƒ¨ç½²**: Docker + Docker Compose
- **åŒ…ç®¡ç†**: pnpm (monorepo)

## æ ¸å¿ƒéœ€æ±‚
1. è¿œç¨‹æœåŠ¡å™¨ä¸Šå¯åŠ¨ Claude Code
2. ç”¨æˆ·é€šè¿‡ Web è®¿é—®ç»ˆç«¯ï¼ŒæŸ¥çœ‹å†å²ï¼Œå®æ—¶äº¤äº’
3. é›†æˆ VS Code (Cursor)ï¼Œåœ¨ Web ä¸ŠæŸ¥çœ‹ä»£ç ä¿®æ”¹

## å¼€å‘è¦æ±‚
- æ‰€æœ‰åŠŸèƒ½éœ€æ±‚è®°å½•åœ¨ FEATURE.md
- æŒç»­ä¿å­˜é¡¹ç›®è®°å¿†åˆ° CLAUDE.md
- å¿…é¡»ç¼–å†™æµ‹è¯•ç”¨ä¾‹ï¼ŒæŒç»­å›å½’æµ‹è¯•

## é¡¹ç›®çŠ¶æ€
- âœ… æŠ€æœ¯è°ƒç ”å®Œæˆ
- âœ… æ¶æ„æ–¹æ¡ˆç¡®å®šï¼ˆè‡ªå»º PTY æ–¹æ¡ˆï¼‰
- âœ… éœ€æ±‚æ–‡æ¡£åˆ›å»º (FEATURE.md)
- âœ… é¡¹ç›®ç»“æ„æ­å»ºå®Œæˆ
- âœ… åç«¯æ¡†æ¶å®ç° (Fastify + WebSocket + node-pty)
- âœ… æµ‹è¯•æ¡†æ¶é…ç½®å®Œæˆ
- âœ… CI/CD æµæ°´çº¿é…ç½®
- âœ… Docker éƒ¨ç½²é…ç½®
- âœ… å‰ç«¯ç•Œé¢å¼€å‘å®Œæˆ
- âœ… ç”¨æˆ·è®¤è¯ç³»ç»Ÿå®ç°
- âœ… WebSocket è¿æ¥æˆåŠŸ
- âœ… xterm.js dimensions é”™è¯¯ä¿®å¤ (StableTerminal)
- âœ… UI æ ·å¼ä¼˜åŒ–ï¼ˆVS Code é£æ ¼ï¼‰
- âœ… WebSocket é”™è¯¯å¤„ç†æ”¹è¿›
- âœ… ä¼šè¯ç®¡ç†åŠŸèƒ½å®ç°ï¼ˆåˆ›å»ºã€åˆ‡æ¢ã€åˆ é™¤ã€é‡å‘½åï¼‰
- âœ… ä¼šè¯æŒä¹…åŒ–å­˜å‚¨å®ç°ï¼ˆPostgreSQLï¼‰
- âœ… ç»ˆç«¯é«˜åº¦è‡ªé€‚åº”ä¿®å¤ï¼ˆFitAddonï¼‰
- âœ… ä¼šè¯è¾“å‡ºç¼“å†²æŒä¹…åŒ–å®ç°
- âœ… ä¼šè¯å†å²æ¢å¤åŠŸèƒ½
- âœ… ç§»åŠ¨ç«¯å“åº”å¼è®¾è®¡å®ç°
- âœ… Session List å®æ—¶æ›´æ–°ï¼ˆWebSocketï¼‰
- âœ… æ™ºèƒ½ CWD æ£€æµ‹ç³»ç»Ÿå®ç°
- âœ… è·¯å¾„æ™ºèƒ½ç¼©å†™æ˜¾ç¤º
- âœ… æ‰§è¡ŒçŠ¶æ€å®æ—¶æ£€æµ‹
- âœ… ç§»åŠ¨ç«¯é”®ç›˜é€‚é…ä¼˜åŒ–
- âœ… iPhone ç™»å½•ç•Œé¢é”®ç›˜å¤„ç†
- âœ… ç§»åŠ¨ç«¯è°ƒè¯•ç•Œé¢å®ç°
- âœ… ç§»åŠ¨ç«¯è™šæ‹Ÿé”®ç›˜å·¥å…·æ ï¼ˆESCã€ç¿»é¡µã€æ–¹å‘é”®ç­‰ï¼‰
- âœ… ä¿®å¤ç§»åŠ¨ç«¯ç»ˆç«¯åˆ·æ–°é—®é¢˜ï¼ˆä¼˜åŒ– ANSI è½¬ä¹‰åºåˆ—å¤„ç†ï¼‰
- ğŸ”„ Claude Code è¿›ç¨‹ç®¡ç†å¼€å‘ä¸­

## å…³é”®å†³ç­–è®°å½•
1. **2025-06-14**: æœ€åˆé€‰æ‹© ttyd æ··åˆæ–¹æ¡ˆï¼Œåå†³å®šä½¿ç”¨ node-pty è‡ªå»ºæ–¹æ¡ˆ
2. **2025-06-14**: ç¡®å®šä½¿ç”¨ Node.js ç”Ÿæ€ç³»ç»Ÿï¼Œä¾¿äºå¿«é€Ÿå¼€å‘å’Œç»´æŠ¤
3. **2025-06-14**: é€‰æ‹© Fastify æ›¿ä»£ Expressï¼Œæå‡æ€§èƒ½
4. **2025-06-14**: ä½¿ç”¨ pnpm ä½œä¸ºåŒ…ç®¡ç†å™¨ï¼Œæ”¯æŒ monorepo ç»“æ„
5. **2025-06-14**: ä¿®å¤ xterm.js dimensions é”™è¯¯ï¼Œé™çº§åˆ° xterm@4.19.0 ç¨³å®šç‰ˆæœ¬
6. **2025-06-14**: åˆ›å»ºå¤šä¸ªç»ˆç«¯ç»„ä»¶å°è¯•ï¼Œæœ€ç»ˆä½¿ç”¨ StableTerminal
7. **2025-06-14**: å®ç°ä¼šè¯æŒä¹…åŒ–ï¼Œä½¿ç”¨ PostgreSQL å­˜å‚¨ä¼šè¯çŠ¶æ€å’Œè¾“å‡ºç¼“å†²
8. **2025-06-14**: ä½¿ç”¨å•ä¾‹æ¨¡å¼ç¡®ä¿ SessionManager ä¸€è‡´æ€§
9. **2025-06-14**: å®ç°è¾“å‡ºç¼“å†²åˆ†å—å­˜å‚¨ï¼Œä¿ç•™ ANSI è½¬ä¹‰åºåˆ—
10. **2025-06-14**: å®ç°ç§»åŠ¨ç«¯å“åº”å¼è®¾è®¡ï¼Œç»Ÿä¸€ä½¿ç”¨å·¦ä¾§ Drawer
11. **2025-06-14**: å®ç°æ™ºèƒ½ CWD æ£€æµ‹ï¼Œä½¿ç”¨ lsof (macOS) å’Œ /proc (Linux)
12. **2025-06-14**: é‡‡ç”¨äº‹ä»¶é©±åŠ¨çš„ CWD æ£€æµ‹ç­–ç•¥æ›¿ä»£å®šæ—¶æ£€æŸ¥
13. **2025-06-14**: å®ç°è·¯å¾„æ™ºèƒ½ç¼©å†™ï¼Œæ”¯æŒä¸­æ–‡ç›®å½•åæ˜¾ç¤º
14. **2025-06-14**: å®ç°ç§»åŠ¨ç«¯é”®ç›˜è‡ªé€‚åº”ï¼Œè§£å†³ iPhone é”®ç›˜é®æŒ¡é—®é¢˜
15. **2025-06-14**: å¼€å‘ç§»åŠ¨ç«¯è°ƒè¯•ç•Œé¢ï¼Œæ”¯æŒå®æ—¶é”™è¯¯è¿½è¸ª
16. **2025-06-14**: å®ç°ç§»åŠ¨ç«¯è™šæ‹Ÿé”®ç›˜å·¥å…·æ ï¼Œæä¾› ESCã€ç¿»é¡µç­‰ç»ˆç«¯å¿«æ·é”®
17. **2025-06-14**: ä¼˜åŒ–ç§»åŠ¨ç«¯ç»ˆç«¯æ¸²æŸ“æ€§èƒ½ï¼Œä¿®å¤ ANSI è½¬ä¹‰åºåˆ—åˆ·æ–°é—®é¢˜
18. **2025-06-14**: å®ç° WebSocket å¿ƒè·³æ£€æµ‹å’Œè¿æ¥æ•°å®¡è®¡æœºåˆ¶

## æŠ€æœ¯ç‰¹æ€§

### æ™ºèƒ½ CWD æ£€æµ‹ç³»ç»Ÿ
- **äº‹ä»¶é©±åŠ¨æ£€æµ‹**: ç”¨æˆ·æŒ‰ Enter å 1 ç§’æ£€æŸ¥ CWD
- **è¾“å‡ºç©ºé—²æ£€æµ‹**: ç»ˆç«¯è¾“å‡ºåœæ­¢ 1 ç§’åæ£€æŸ¥ CWD  
- **è·¨å¹³å°æ”¯æŒ**: macOS ä½¿ç”¨ lsofï¼ŒLinux ä½¿ç”¨ /proc
- **å®šæ—¶å™¨ç®¡ç†**: æ¯ä¸ª session ç‹¬ç«‹å®šæ—¶å™¨ï¼Œæ”¯æŒè‡ªåŠ¨æ¸…ç†
- **ç²¾ç¡® lsof å‘½ä»¤**: `lsof -p PID -a -d cwd | tail -n +2 | awk '{print $NF}'`

### è·¯å¾„æ™ºèƒ½ç¼©å†™
- **Home ç›®å½•**: `/Users/fbzhong/Downloads/ç®€å†` â†’ `~/D/ç®€å†`
- **é Home ç›®å½•**: `/var/log/nginx/access.log` â†’ `/V/L/N/access.log`
- **ä¸­æ–‡æ”¯æŒ**: æ”¯æŒä¸­æ–‡ç›®å½•åçš„é¦–å­—æ¯ç¼©å†™
- **æ™ºèƒ½è§„åˆ™**: ä¿ç•™æœ€åä¸€çº§ç›®å½•å®Œæ•´åç§°ï¼Œä¸­é—´ç›®å½•é¦–å­—æ¯å¤§å†™

### å®æ—¶çŠ¶æ€æ£€æµ‹
- **æ‰§è¡ŒçŠ¶æ€**: æ£€æµ‹ shell æ˜¯å¦æœ‰ç¨‹åºæ­£åœ¨æ‰§è¡Œ
- **WebSocket å®æ—¶æ›´æ–°**: Session List å®æ—¶æ˜¾ç¤º CWDã€å‘½ä»¤ã€çŠ¶æ€
- **è§†è§‰æŒ‡ç¤ºå™¨**: æ‰§è¡Œä¸­æ˜¾ç¤ºåŠ¨ç”»å›¾æ ‡ï¼Œç©ºé—²æ˜¾ç¤ºçŠ¶æ€åœ†ç‚¹
- **è‡ªåŠ¨é‡è¿**: WebSocket è¿æ¥æ–­å¼€æ—¶è‡ªåŠ¨é‡è¯•

### å“åº”å¼è®¾è®¡
- **ç»Ÿä¸€ Drawer**: PC å’Œç§»åŠ¨ç«¯éƒ½ä½¿ç”¨å·¦ä¾§æŠ½å±‰å¼ Session åˆ—è¡¨
- **Material-UI**: ä½¿ç”¨ Material-UI ç»„ä»¶å®ç°ç°ä»£åŒ–ç•Œé¢
- **æ–­ç‚¹é€‚é…**: é’ˆå¯¹ä¸åŒå±å¹•å°ºå¯¸ä¼˜åŒ–å¸ƒå±€å’Œå­—ä½“å¤§å°

### ç§»åŠ¨ç«¯é”®ç›˜é€‚é…
- **é”®ç›˜æ£€æµ‹**: ä½¿ç”¨ visualViewport API å’Œ resize äº‹ä»¶æ£€æµ‹é”®ç›˜çŠ¶æ€
- **å¸ƒå±€è‡ªé€‚åº”**: é”®ç›˜æ‰“å¼€æ—¶è‡ªåŠ¨è°ƒæ•´ç•Œé¢å¸ƒå±€ï¼Œé¿å…è¾“å…¥æ¡†è¢«é®æŒ¡
- **è‡ªåŠ¨æ»šåŠ¨**: èšç„¦è¾“å…¥æ¡†æ—¶è‡ªåŠ¨æ»šåŠ¨åˆ°å¯è§†åŒºåŸŸ
- **é˜²ç¼©æ”¾**: è®¾ç½®è¾“å…¥æ¡†å­—ä½“å¤§å°ä¸º 16pxï¼Œé˜²æ­¢ iOS Safari è‡ªåŠ¨ç¼©æ”¾
- **è°ƒè¯•ç•Œé¢**: æä¾›å¯è§†åŒ–è°ƒè¯•é¢æ¿ï¼Œæ–¹ä¾¿ç§»åŠ¨ç«¯é”™è¯¯æ’æŸ¥

### ç§»åŠ¨ç«¯è™šæ‹Ÿé”®ç›˜å·¥å…·æ 
- **å¿«æ·é”®æ”¯æŒ**: ESCã€Tabã€Shift+Tabã€Ctrl+Cã€Ctrl+D ç­‰å¸¸ç”¨ç»ˆç«¯å¿«æ·é”®
- **å¯¼èˆªé”®**: Homeã€Endã€Page Upã€Page Down
- **æ–¹å‘é”®**: å®Œæ•´çš„ä¸Šä¸‹å·¦å³æ–¹å‘é”®å¸ƒå±€
- **æ‰©å±•åŠŸèƒ½**: Ctrl+Lï¼ˆæ¸…å±ï¼‰ã€Ctrl+A/Eï¼ˆè¡Œé¦–/è¡Œå°¾ï¼‰ã€Ctrl+Zï¼ˆæŒ‚èµ·ï¼‰
- **ç¼–è¾‘å™¨æ”¯æŒ**: Ctrl+W/K/U/O/X ç­‰ nano ç¼–è¾‘å™¨å¿«æ·é”®
- **æ‚¬æµ®æŒ‰é’®**: å¯ç‚¹å‡»åˆ‡æ¢å·¥å…·æ æ˜¾ç¤º/éšè—
- **å“åº”å¼è®¾è®¡**: ä»…åœ¨ç§»åŠ¨è®¾å¤‡ä¸Šæ˜¾ç¤ºï¼ŒPC ç«¯è‡ªåŠ¨éšè—

### ç§»åŠ¨ç«¯ç»ˆç«¯ä¼˜åŒ–
- **DOM æ¸²æŸ“å™¨**: ç§»åŠ¨è®¾å¤‡ä½¿ç”¨ DOM æ¸²æŸ“å™¨æ›¿ä»£ Canvasï¼Œæé«˜ç¨³å®šæ€§
- **å†™å…¥ç¼“å†²**: æ‰¹é‡å¤„ç†ç»ˆç«¯è¾“å‡ºï¼Œå‡å°‘é‡ç»˜æ¬¡æ•°
- **æ™ºèƒ½åˆ·æ–°**: æ£€æµ‹å…‰æ ‡å®šä½åºåˆ—ï¼Œä¼˜åŒ–è¿›åº¦æ¡ç­‰æ›´æ–°åœºæ™¯
- **ANSI åºåˆ—ä¼˜åŒ–**: åˆå¹¶å†—ä½™å…‰æ ‡ç§»åŠ¨ï¼Œç®€åŒ–é¢œè‰²ä»£ç 
- **Resize é˜²æŠ–**: å¢åŠ å°ºå¯¸å˜åŒ–é˜ˆå€¼å’Œå»¶è¿Ÿï¼Œé¿å…é¢‘ç¹é‡æ’
- **æ€§èƒ½è°ƒä¼˜**: å‡å°‘æ»šåŠ¨ç¼“å†²åŒºå¤§å°ï¼Œç¦ç”¨å…‰æ ‡é—ªçƒ

### è¿æ¥ç®¡ç†å’Œç¨³å®šæ€§
- **WebSocket å¿ƒè·³**: æ¯ 30 ç§’å‘é€ ping/pong æ£€æµ‹è¿æ¥çŠ¶æ€
- **è‡ªåŠ¨æ–­å¼€**: å¿ƒè·³å¤±è´¥æ—¶è‡ªåŠ¨ç»ˆæ­¢æ­»è¿æ¥
- **è¿æ¥æ•°å®¡è®¡**: å®šæœŸæ£€æŸ¥å¹¶ä¿®æ­£è¿‡æœŸçš„è¿æ¥è®¡æ•°
- **ä¼šè¯æ¸…ç†**: è‡ªåŠ¨æ¸…ç†è¶…è¿‡ 24 å°æ—¶çš„æ­»ä¼šè¯
- **å®æ—¶æ›´æ–°**: è¿æ¥/æ–­å¼€äº‹ä»¶é€šè¿‡ WebSocket å¹¿æ’­æ›´æ–°

## æµ‹è¯•ç­–ç•¥
- å•å…ƒæµ‹è¯•è¦†ç›–ç‡ > 80%
- é›†æˆæµ‹è¯•è¦†ç›–æ‰€æœ‰ API
- ç«¯åˆ°ç«¯æµ‹è¯•è¦†ç›–å…³é”®ç”¨æˆ·æµç¨‹
- æ¯æ¬¡æäº¤è‡ªåŠ¨è¿è¡Œå›å½’æµ‹è¯•

## å¸¸ç”¨å‘½ä»¤
```bash
# å¼€å‘ç¯å¢ƒå¯åŠ¨
# åç«¯ (ç«¯å£ 12021)
cd backend && pnpm run dev

# å‰ç«¯ (ç«¯å£ 12020)  
cd frontend && pnpm start

# è¿è¡Œæµ‹è¯•
pnpm test

# æ„å»ºç”Ÿäº§ç‰ˆæœ¬
pnpm build

# å®‰è£…ä¾èµ–
pnpm install

# å¥åº·æ£€æŸ¥
curl http://localhost:12021/health
```

